<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.33">

  <meta name="author" content="Emanuele Giorgi, Claudio Fronterre, Jana Purkiss, Freya Clark">
  <title>Welcome to My Personal Website – Accounting for the impact of mass-drug administration for NTDs prevalence mapping using geostatistical methods</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-8a5cdbf101a0845817b98f2425171703.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Accounting for the impact of mass-drug administration for NTDs prevalence mapping using geostatistical methods</h1>
  <p class="subtitle">A decay-adjusted spatio-temporal (DAST) model</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Emanuele Giorgi, Claudio Fronterre, Jana Purkiss, Freya Clark 
</div>
        <p class="quarto-title-affiliation">
            Lancaster University
          </p>
    </div>
</div>

</section>
<section id="presentation-overview" class="slide level2">
<h2>Presentation Overview</h2>
<ol type="1">
<li><strong>Neglected Tropical Diseases and Mass Drug Administration</strong></li>
<li><strong>The standard geostatistical model for prevalence mapping</strong></li>
<li><strong>A decay-adjusted spatio-temporal model</strong></li>
<li><strong>Application to lymphatic filariasis in Madagascar</strong></li>
<li><strong>Summary</strong></li>
</ol>
</section>
<section id="neglected-tropical-diseases" class="slide level2">
<h2>Neglected tropical diseases</h2>

<img data-src="figures/Figure-12.png" class="r-stretch"></section>
<section id="ntd-endemic-areas" class="slide level2">
<h2>NTD endemic areas</h2>

<img data-src="figures/Prevalence-of-neglected-tropical-diseases-NTDs-by-country-The-burden-of-NTDs-in_W640.jpg" class="r-stretch"></section>
<section id="the-impact-of-ntds" class="slide level2">
<h2>The impact of NTDs</h2>

<img data-src="figures/Ranking-of-NTDs-by-Disease-Burden-DALYs-and-Comparison-with-HIV-AIDS-Tuberculosis-and.png" style="width:35.0%" class="r-stretch"></section>
<section id="ntds-risk-factors" class="slide level2 smaller">
<h2>NTDs Risk Factors</h2>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="figures/D200-0790-138A-2.jpg"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="figures/Five-Diseases-That-Thrive-in-Poor-Sanitation.jpg"></p>
</div>
</div>
</div>
<p><strong>Common risk factors:</strong><br>
- Poor sanitation and lack of clean water<br>
- Limited healthcare access<br>
- Poverty and overcrowding<br>
- Exposure to disease vectors (e.g., mosquitoes, flies)<br>
- Lack of education and awareness</p>
</section>
<section id="mass-drug-administration-mda-a-preventive-strategy" class="slide level2 smaller">
<h2>Mass Drug Administration (MDA): A Preventive Strategy</h2>
<p><strong>What is MDA?</strong> Mass Drug Administration involves the periodic distribution of safe, effective medications to <strong>entire at-risk populations</strong>—regardless of disease status—to reduce transmission and prevent infections.</p>
<div class="fragment">
<p><strong>Why is it used?</strong></p>
<ul>
<li><p>Controls or eliminates disease in endemic areas</p></li>
<li><p>Reduces the community-level parasite burden</p></li>
<li><p>Prevents long-term complications and disability</p></li>
</ul>
</div>
<div class="fragment">
<p><strong>Key Features:</strong></p>
<ul>
<li><p>Delivered at regular intervals (annually or biannually)</p></li>
<li><p>Often combined with public health education</p></li>
<li><p>Supported by WHO and major global health initiatives</p></li>
</ul>
</div>
</section>
<section id="albendazole" class="slide level2 smaller">
<h2>Albendazole</h2>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<p><img data-src="figures/albe.jpg"></p>
</div><div class="column quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<p><strong>How it works:</strong><br>
Albendazole disrupts the metabolism of parasitic worms by inhibiting microtubule formation, which is essential for their survival.</p>
<aside class="notes">
<p>Albendazole works by stopping worms from absorbing the nutrients they need to survive. It blocks a process inside their cells that’s kind of like the framework or “skeleton” that helps them function and grow. Without it, the worms can’t live for long and are eventually cleared from the body.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<p><strong>Used for NTDs such as:</strong></p>
<ul>
<li><p>Lymphatic filariasis (in combination with ivermectin or DEC)</p></li>
<li><p>Soil-transmitted helminths (e.g., ascariasis, hookworm, trichuriasis)</p></li>
</ul>
<p><strong>MDA use:</strong><br>
Distributed in large-scale deworming campaigns, particularly targeting children and at-risk communities.</p>
</div></div>
</div>
</section>
<section id="ivermectin" class="slide level2 smaller">
<h2>Ivermectin</h2>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<p><img data-src="figures/ivermectin.jpg"></p>
</div><div class="column quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<p><strong>How it works:</strong></p>
<p>Ivermectin paralyzes and kills parasites by interfering with their nerve and muscle function via chloride channel disruption. Parasites cannot move and feed.</p>
<aside class="notes">
<p><strong>Ivermectin kills parasites by messing with their nerves and muscles, which causes them to become paralyzed and die.</strong> It stops them from moving and feeding, so the body can get rid of them.</p>
<p>Chloride channel disruption refers to any impairment in the normal function of chloride channels, which are protein pores in cell membranes that allow chloride ions (Cl-) to pass through.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<p><strong>Used for NTDs such as:</strong></p>
<ul>
<li><p>Onchocerciasis (river blindness)<br>
</p></li>
<li><p>Lymphatic filariasis (in combination with albendazole)<br>
</p></li>
<li><p>Strongyloidiasis</p></li>
</ul>
<p><strong>MDA use:</strong> Ivermectin is given to both adults and children (weighing more than 15kg), but its use is carefully considered for pregnant women.</p>
</div></div>
</div>
</section>
<section id="praziquantel" class="slide level2 smaller">
<h2>Praziquantel</h2>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<p><img data-src="figures/praz.jpg"></p>
</div><div class="column quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<p><strong>How it works:</strong><br>
Praziquantel increases permeability of the parasite’s cell membranes to calcium ions, causing muscle contraction and paralysis.</p>
<aside class="notes">
<p>Praziquantel makes the outer layer of the parasite’s cells more “leaky,” allowing calcium to enter. This causes the parasite’s muscles to tighten and paralyze it, making it easier for the body to get rid of it.</p>
<p>Inside the cells of parasites, calcium is important for controlling muscle movement. When calcium enters the parasite’s cells (which normally isn’t supposed to happen), it disrupts the normal function of the muscles.</p>
<p>This excess calcium makes the muscles contract and become stiff. The parasite can’t move properly or feed, and it becomes paralyzed, which allows the body to get rid of it. So, calcium causes the parasite’s muscles to freeze up, stopping it from surviving or causing further harm.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<p><strong>Used for NTDs such as:</strong><br>
</p>
<ul>
<li><p>Schistosomiasis<br>
</p></li>
<li><p>Tapeworm infections</p></li>
</ul>
<p><strong>MDA use:</strong><br>
Key drug in school-based and community-wide treatment campaigns in regions with high schistosomiasis burden.</p>
</div></div>
</div>
</section>
<section id="treating-ntds" class="slide level2 smaller">
<h2>Treating NTDs</h2>
<div class="cell" data-tbl-width="compact">
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true" style="font-size: 27px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Disease</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Alb</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">PZQ</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">IVM</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">AZM</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">DEC</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">MOX</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">STH</td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">MBD</td>
</tr>
<tr class="even">
<td style="text-align: center;">Schisto</td>
<td style="text-align: center;">✓†</td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">OXA</td>
</tr>
<tr class="odd">
<td style="text-align: center;">LF</td>
<td style="text-align: center;">✓†</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;">DOX*</td>
</tr>
<tr class="even">
<td style="text-align: center;">Trachoma</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">✓‡</td>
<td style="text-align: center;">✓</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">TEO</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Abbreviations:</strong></p>
<p>Alb = Albendazole, PZQ = Praziquantel, IVM = Ivermectin, AZM = Azithromycin, DEC = Diethylcarbamazine, MOX = Moxidectin, MBD = Mebendazole, OXA = Oxamniquine, DOX = Doxycycline, TEO = Tetracycline eye ointment</p>
<p><strong>Symbols:</strong></p>
<p>† Used in combination therapy</p>
<p>‡ Only in onchocerciasis co-endemic areas</p>
<p>*Adjunctive treatment</p>
<aside class="notes">
<p><strong>Key Explanations:</strong> - <strong>combo</strong>: Combination therapy enhances efficacy (e.g., albendazole+praziquantel for schistosomiasis kills both juvenile and adult worms)</p>
<ul>
<li><strong>co-endemic areas only</strong> (trachoma/ivermectin):
<ul>
<li>Ivermectin is only recommended for trachoma in areas where onchocerciasis (river blindness) is also present because:
<ol type="1">
<li><strong>In onchocerciasis-endemic areas</strong>: Mass ivermectin distribution is already occurring for river blindness control, so it can simultaneously help reduce trachoma transmission</li>
<li><strong>In non-onchocerciasis areas</strong>:
<ul>
<li>Azithromycin is preferred as the primary trachoma treatment because:
<ul>
<li>It has direct antibacterial action against Chlamydia trachomatis</li>
<li>Better safety profile for children and pregnant women</li>
<li>Additional community-wide benefits against other bacterial infections</li>
</ul></li>
<li>Ivermectin isn’t contraindicated, but simply less optimal than azithromycin for trachoma-specific control</li>
</ul></li>
</ol></li>
</ul></li>
<li><strong>adjunct</strong>:
<ul>
<li>Secondary treatment that supports but doesn’t replace primary therapy</li>
<li>Example: Doxycycline for LF kills Wolbachia bacteria inside adult worms, making them sterile (used alongside albendazole/ivermectin)</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="assessing-mda-impact" class="slide level2 smaller scrollable">
<h2>Assessing MDA Impact</h2>
<p><strong>Timeframe for observable impact:</strong></p>
<ul>
<li><p>STH: Reduced prevalence seen after 1-2 annual rounds</p></li>
<li><p>Schistosomiasis: Egg reduction visible after 1-2 years</p></li>
<li><p>LF: Microfilariae reduction within months, but breaking transmission requires 5+ years</p></li>
<li><p>Trachoma: Active disease reduction in 1-3 years</p></li>
</ul>
<p><strong>Monitoring surveys:</strong></p>
<ul>
<li><p>Baseline surveys (pre-MDA)</p></li>
<li><p>Transmission Assessment Surveys (TAS) for LF after 5+ rounds</p></li>
<li><p>Impact surveys (after 3-5 rounds)</p></li>
<li><p>Post-treatment surveillance (after reaching elimination targets)</p></li>
</ul>
<p><strong>Key indicators:</strong></p>
<ul>
<li><p>Parasitological prevalence (STH, schisto)</p></li>
<li><p>Antigenemia (LF)</p></li>
<li><p>TF/TI rates (trachoma)</p></li>
<li><p>Entomological indices (for vector-borne NTDs)</p></li>
</ul>
</section>
<section id="modelling-the-impact-of-mda" class="slide level2">
<h2>Modelling the impact of MDA</h2>

<img data-src="Lund2025_files/figure-revealjs/unnamed-chunk-2-1.png" width="768" class="r-stretch"></section>
<section id="the-standard-geostatistical-model-for-prevalence-mapping" class="slide level2 scrollable smaller">
<h2>The standard geostatistical model for prevalence mapping</h2>
<ul>
<li><strong>Outcome</strong>: <span class="math inline">\(Y_i\)</span> number of cases out <span class="math inline">\(n_i\)</span> sampled</li>
</ul>
<div class="fragment">
<ul>
<li><strong>Locations</strong>: <span class="math inline">\(X = (x_1, \ldots, x_n)\)</span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><strong>Covariates</strong> (optional): <span class="math inline">\(d(x)\)</span> (e.g.&nbsp;elevation, distance from waterways)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><strong>Spatial Gaussian process</strong>: <span class="math inline">\(S(x)\)</span> (stationary and isotropic) <span class="math display">\[
{\rm cov}\{S(x), S(x')\} = \sigma^2 \rho(||x - x'||; \phi)
\]</span> Example: <span class="math inline">\(\rho(u; \phi) = \exp\{-u/\phi\}\)</span>.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><strong>Conditional independence</strong>: <span class="math inline">\(Y_{i}\)</span> conditionally on <span class="math inline">\(S(x_i)\)</span> are mutually independent <span class="math inline">\(Bin(n_i , p(x_i))\)</span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>The <strong>linear predictor</strong> <span class="math display">\[
\log\left\{\frac{p(x_i)}{1-p(x_i)}\right\} = \beta_0 + d(x_i)^\top \beta + S(x_i)
\]</span></li>
</ul>
</div>
</section>
<section id="spatial-and-temporal-confounding-with-mda" class="slide level2 smaller">
<h2>Spatial and temporal confounding with MDA</h2>
<center>
<img data-src="figures/scenario_surveys.png">
</center>
<p><strong>Issues:</strong></p>
<ul>
<li><p>Areas with different levels of transmission are sampled at different times.</p></li>
<li><p>Use of MDA rounds can even show a positive associated with disease risk</p></li>
</ul>
</section>
<section id="modelling-the-impact-of-mda-1" class="slide level2 smaller">
<h2>Modelling the Impact of MDA</h2>
<p>We model observed prevalence <span class="math inline">\(P(x,t)\)</span> as a product of:</p>
<ul>
<li><strong>Counterfactual prevalence</strong>, <span class="math inline">\(P^*(x,t)\)</span>, in the absence of MDA</li>
<li>A <strong>cumulative MDA effect</strong>, based on rounds of effective treatment</li>
</ul>
<p><span class="math display">\[
P(x, t) = P^*(x, t)\prod_{j=1}^{r(t)} \left[1 - f(t - u_j)\right]^{I(x, u_j)}
\]</span></p>
<ul>
<li><span class="math inline">\(u_j\)</span>: times of effective MDA rounds<br>
</li>
<li><span class="math inline">\(I(x, u_j)\)</span>: indicator of MDA coverage at location <span class="math inline">\(x\)</span> and time <span class="math inline">\(u_j\)</span></li>
<li><span class="math inline">\(r(t)\)</span> is the number of MDA rounds carried out before time <span class="math inline">\(t\)</span></li>
</ul>
</section>
<section id="parametric-form-of-mda-decay-function" class="slide level2 smaller">
<h2>Parametric form of MDA decay function</h2>
<p><span class="math display">\[
f(v) = \alpha \exp\left\{ -\left(\frac{v}{\gamma}\right)^{\kappa} \right\}
\]</span></p>
<ul>
<li><span class="math inline">\(\alpha\)</span>: maximum reduction immediately after MDA<br>
</li>
<li><span class="math inline">\(\gamma\)</span>: scale of decay<br>
</li>
<li><span class="math inline">\(\kappa\)</span>: shape of decay (fixed)</li>
</ul>
<center>
<img data-src="figures/f_mda.jpg" style="width:40.0%">
</center>
</section>
<section id="monte-carlo-maximum-likelihood" class="slide level2 smaller scrollable">
<h2>Monte Carlo Maximum Likelihood</h2>
<ul>
<li>Let <span class="math inline">\(W_i = S(x_i) + Z_i\)</span> and <span class="math inline">\(W = (W_1, \ldots, W_n)\)</span></li>
</ul>
<div class="fragment">
<ul>
<li><p>The likelihood function for parameters <span class="math inline">\(\theta = (\beta, \sigma^2, \phi, \tau^2)\)</span> is given by:</p>
<p><span class="math display">\[
L(\theta) = \int N(W; D\beta, \Omega) f(y| W) dW
\]</span></p>
<p>where <span class="math inline">\(\Omega = \sigma^2 R(\phi) + \tau^2I_n\)</span>.</p></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><p>We approximate this using Monte Carlo integration:</p>
<p><span class="math display">\[
L_m(\theta) = \frac{1}{B} \sum_{j=1}^{B} \frac{N\left(W^{(j)}; D\beta, \Omega \right)}{N\left(W^{(j)}; D\beta_0, \Omega_0\right)}
\]</span> where <span class="math inline">\(W^{(i)}\)</span> are sampled from the distribution of <span class="math inline">\(W\)</span> given <span class="math inline">\(y\)</span> using an MCMC algorithm.</p></li>
<li><p>All implemented in the <code>dast</code> function of the <code>RiskMap</code> package <img src="figures/excitement.png" width="80" height="80" style="vertical-align: middle;"></p></li>
</ul>
</div>
</section>
<section id="applications" class="slide level2">
<h2>Applications</h2>
<ul>
<li><p><a href="#/lf-slide">Lymphatic filariasis in Madagascar</a></p></li>
<li><p><a href="#/sth-slide">Soil-transmitted helminths in Kenya</a></p></li>
</ul>
</section>
<section id="lf-slide" class="slide level2">
<h2>Example: Lymphatic filariasis in Madagascar</h2>
<center>
<img data-src="figures/lf.png" style="width:60.0%">
</center>
</section>
<section id="the-data" class="slide level2">
<h2>The data</h2>
<div style="width: 100%; height: 900px; position: relative;">
<iframe src="lf_madagascar.html" width="100%" height="70%" style="border: none; position: absolute; top: 0; left: 0;">
</iframe>
</div>
</section>
<section id="timeline-of-surveys-and-mda" class="slide level2">
<h2>Timeline of surveys and MDA</h2>
<center>
<img data-src="figures/mdg_data.png" style="width:55.0%">
</center>
</section>
<section id="monotone-likelihood-for-alpha" class="slide level2">
<h2>Monotone likelihood for <span class="math inline">\(\alpha\)</span></h2>
<center>
<img data-src="figures/profile_alpha.jpg" style="width:50.0%">
</center>
</section>
<section id="introducing-penalization-for-alpha" class="slide level2 smaller scrollable">
<h2>Introducing penalization for <span class="math inline">\(\alpha\)</span></h2>
<ul>
<li>Let <span class="math inline">\(p(\alpha) &gt; 0\)</span> be a positive function.</li>
</ul>
<div class="fragment">
<ul>
<li>The penalized likelihood for <span class="math inline">\(\alpha\)</span> is <span class="math display">\[
L_{p}(\theta) = L(\theta) - p(\alpha)
\]</span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><p>Proposed penalty</p>
<p><span class="math display">\[
p(\alpha) = -\left[\lambda_1 \log\alpha + \lambda_2\log(1-\alpha) \right]
\]</span></p></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>We set <span class="math inline">\(\lambda_1 = 20\)</span> and <span class="math inline">\(\lambda_2 = 14\)</span>. (This inspired by a Beta distribution with mode in around 0.6, with 0.42 and 0.7 as its 0.025 and 0.975 quantiles, respectively.)</li>
</ul>
<center>
<img data-src="figures/beta_distr.png" style="width:40.0%">
</center>
</div>
</section>
<section id="introducing-penalization-for-alpha-1" class="slide level2 smaller">
<h2>Introducing penalization for <span class="math inline">\(\alpha\)</span></h2>
<center>
<img data-src="figures/penalized_profile_alpha.jpg" style="width:50.0%">
</center>
</section>
<section id="paramter-estimates" class="slide level2">
<h2>Paramter estimates</h2>
<p>MDA impact function: <span class="math inline">\(f(v) = \alpha\exp\{-v/\gamma\}\)</span>, with <span class="math inline">\(v\)</span> denoting the years since last MDA</p>
<div class="fragment">
<table class="caption-top">
<thead>
<tr class="header">
<th>Parameter</th>
<th>Estimates</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercept</td>
<td>-2.582 (-2.622, -2.541)</td>
</tr>
<tr class="even">
<td>Spatial variance</td>
<td>2.204 (1.891, 2.569)</td>
</tr>
<tr class="odd">
<td>Spatial scale</td>
<td>79.153 (70.874, 88.399)</td>
</tr>
<tr class="even">
<td>Max. reduction (<span class="math inline">\(\alpha\)</span>)</td>
<td>0.856 (0.839, 0.872)</td>
</tr>
<tr class="odd">
<td>Decay scale (<span class="math inline">\(\gamma\)</span>)</td>
<td>1.802 (1.768, 1.837)</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="estimated-mda-impact-function" class="slide level2">
<h2>Estimated MDA impact function</h2>
<center>
<img data-src="figures/mdg_mda_f.png">
</center>
</section>
<section id="prevalence-prediction-2000-2024" class="slide level2">
<h2>Prevalence prediction 2000-2024</h2>
<center>
<img data-src="figures/prevalence_animation.gif">
</center>
</section>
<section id="sth-slide" class="slide level2">
<h2>Example: soil-transmitted helminths in Kenya</h2>
<center>
<img data-src="figures/sth_cycle.jpg">
</center>
</section>
<section id="the-data-1" class="slide level2">
<h2>The data</h2>
<div style="width: 100%; height: 900px; position: relative;">
<iframe src="sth_kenya.html" width="100%" height="70%" style="border: none; position: absolute; top: 0; left: 0;">
</iframe>
</div>
</section>
<section id="timeline-of-surveys-and-mda-1" class="slide level2">
<h2>Timeline of surveys and MDA</h2>
<center>
<img data-src="figures/kenya_data.png" style="width:55.0%">
</center>
</section>
<section id="paramter-estimates-1" class="slide level2 smaller">
<h2>Paramter estimates</h2>
<p>MDA impact function: <span class="math inline">\(f(v) = \alpha\exp\{-v/\gamma\}\)</span>, with <span class="math inline">\(v\)</span> denoting the years since last MDA</p>
<div class="fragment">
<table class="caption-top">
<colgroup>
<col style="width: 20%">
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Ascaris</th>
<th>Trichuris</th>
<th>Hookworm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Intercept</strong></td>
<td>-2.41 (-2.45, -2.37)</td>
<td>-2.44 (-2.51, -2.37)</td>
<td>-1.94 (-1.98, -1.90)</td>
</tr>
<tr class="even">
<td><strong>Spatial variance</strong></td>
<td>26.83 (14.70, 48.97)</td>
<td>15.57 (8.35, 29.06)</td>
<td>29.75 (20.17, 43.89)</td>
</tr>
<tr class="odd">
<td><strong>Spatial scale</strong></td>
<td>263.31 (178.38, 388.66)</td>
<td>109.02 (72.34, 164.32)</td>
<td>198.63 (152.33, 258.99)</td>
</tr>
<tr class="even">
<td><strong>Max. reduction (<span class="math inline">\(\alpha\)</span>)</strong></td>
<td>0.318 (0.299, 0.338)</td>
<td>0.837 (0.533, 0.958)</td>
<td>0.892 (0.871, 0.909)</td>
</tr>
<tr class="odd">
<td><strong>Decay scale (<span class="math inline">\(\gamma\)</span>)</strong></td>
<td>9.49 (7.41, 12.16)</td>
<td>1.23 (1.01, 1.49)</td>
<td>6.46 (6.06, 6.90)</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="the-mda-impact-by-sth-species" class="slide level2">
<h2>The MDA impact by STH species</h2>
<center>
<img data-src="figures/MDA_effects.png">
</center>
</section>
<section id="prevalence-prediction-2012-2023" class="slide level2">
<h2>Prevalence prediction 2012-2023</h2>
<center>
<img data-src="figures/STH_grid_animation.gif" style="width:75.0%">
</center>
<center>
<img data-src="figures/STH_sc_animation.gif" style="width:75.0%">
</center>
</section>
<section id="next-steps-and-extenions" class="slide level2 smaller">
<h2>Next steps and extenions</h2>
<ul>
<li><p>Need for extension that includes <span class="math inline">\(S(x,t)\)</span> rather than <span class="math inline">\(S(x)\)</span>.</p></li>
<li><p>Apply DAST to other NTDs.</p></li>
<li><p>Key assumptions of DAST</p>
<ul>
<li><p>The MDA effect is the same across time</p></li>
<li><p>Incorporating data from multiple diagnostics</p></li>
<li><p>Accounting for the effect of different types of treatments</p></li>
<li><p>Uncertainty in the MDA coverage</p></li>
</ul></li>
</ul>
</section>
<section id="thank-you" class="slide level2 smaller">
<h2>THANK YOU!</h2>
<center>
<img data-src="figures/questions.jpg" style="height:4in">
</center>
<p>🔗 <a href="https://giorgistat.github.io">giorgistat.github.io</a><br>
📧 e.giorgi@lancaster.ac.uk<br>
📍 CHICAS, Lancaster Medical School, Lancaster University, UK</p>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="figures/clogo.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/62e5c619-9e86-411a-997c-994c703863e6\.netlify\.app\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>