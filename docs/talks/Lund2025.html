<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Emanuele Giorgi, Claudio Fronterre, Jana Purkiss, Freya Clark">

<title>Accounting for the impact of mass-drug administration for NTDs prevalence mapping using geostatistical methods ‚Äì Welcome to My Personal Website</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-2a0ac3da282dc2b09897d71ea71da634.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Welcome to My Personal Website</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../books.html"> 
<span class="menu-text">Books</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../projects/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-publications" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Publications</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-publications">    
        <li>
    <a class="dropdown-item" href="../publications/index.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../publications/original-research.html">
 <span class="dropdown-text">Original Research</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../publications/book-chapters.html">
 <span class="dropdown-text">Book Chapters</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../publications/other-publications.html">
 <span class="dropdown-text">Other Publications</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../talks/index.html"> 
<span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../teaching/index.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#presentation-overview" id="toc-presentation-overview" class="nav-link active" data-scroll-target="#presentation-overview">Presentation Overview</a></li>
  <li><a href="#neglected-tropical-diseases" id="toc-neglected-tropical-diseases" class="nav-link" data-scroll-target="#neglected-tropical-diseases">Neglected tropical diseases</a></li>
  <li><a href="#ntd-endemic-areas" id="toc-ntd-endemic-areas" class="nav-link" data-scroll-target="#ntd-endemic-areas">NTD endemic areas</a></li>
  <li><a href="#the-impact-of-ntds" id="toc-the-impact-of-ntds" class="nav-link" data-scroll-target="#the-impact-of-ntds">The impact of NTDs</a></li>
  <li><a href="#ntds-risk-factors" id="toc-ntds-risk-factors" class="nav-link" data-scroll-target="#ntds-risk-factors">NTDs Risk Factors</a></li>
  <li><a href="#mass-drug-administration-mda-a-preventive-strategy" id="toc-mass-drug-administration-mda-a-preventive-strategy" class="nav-link" data-scroll-target="#mass-drug-administration-mda-a-preventive-strategy">Mass Drug Administration (MDA): A Preventive Strategy</a></li>
  <li><a href="#albendazole" id="toc-albendazole" class="nav-link" data-scroll-target="#albendazole">Albendazole</a></li>
  <li><a href="#ivermectin" id="toc-ivermectin" class="nav-link" data-scroll-target="#ivermectin">Ivermectin</a></li>
  <li><a href="#praziquantel" id="toc-praziquantel" class="nav-link" data-scroll-target="#praziquantel">Praziquantel</a></li>
  <li><a href="#treating-ntds" id="toc-treating-ntds" class="nav-link" data-scroll-target="#treating-ntds">Treating NTDs</a></li>
  <li><a href="#assessing-mda-impact" id="toc-assessing-mda-impact" class="nav-link" data-scroll-target="#assessing-mda-impact">Assessing MDA Impact</a></li>
  <li><a href="#modelling-the-impact-of-mda" id="toc-modelling-the-impact-of-mda" class="nav-link" data-scroll-target="#modelling-the-impact-of-mda">Modelling the impact of MDA</a></li>
  <li><a href="#the-standard-geostatistical-model-for-prevalence-mapping" id="toc-the-standard-geostatistical-model-for-prevalence-mapping" class="nav-link" data-scroll-target="#the-standard-geostatistical-model-for-prevalence-mapping">The standard geostatistical model for prevalence mapping</a></li>
  <li><a href="#spatial-and-temporal-confounding-with-mda" id="toc-spatial-and-temporal-confounding-with-mda" class="nav-link" data-scroll-target="#spatial-and-temporal-confounding-with-mda">Spatial and temporal confounding with MDA</a></li>
  <li><a href="#modelling-the-impact-of-mda-1" id="toc-modelling-the-impact-of-mda-1" class="nav-link" data-scroll-target="#modelling-the-impact-of-mda-1">Modelling the Impact of MDA</a></li>
  <li><a href="#parametric-form-of-mda-decay-function" id="toc-parametric-form-of-mda-decay-function" class="nav-link" data-scroll-target="#parametric-form-of-mda-decay-function">Parametric form of MDA decay function</a></li>
  <li><a href="#monte-carlo-maximum-likelihood" id="toc-monte-carlo-maximum-likelihood" class="nav-link" data-scroll-target="#monte-carlo-maximum-likelihood">Monte Carlo Maximum Likelihood</a></li>
  <li><a href="#applications" id="toc-applications" class="nav-link" data-scroll-target="#applications">Applications</a></li>
  <li><a href="#lf-slide" id="toc-lf-slide" class="nav-link" data-scroll-target="#lf-slide">Example: Lymphatic filariasis in Madagascar</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">The data</a></li>
  <li><a href="#timeline-of-surveys-and-mda" id="toc-timeline-of-surveys-and-mda" class="nav-link" data-scroll-target="#timeline-of-surveys-and-mda">Timeline of surveys and MDA</a></li>
  <li><a href="#monotone-likelihood-for-alpha" id="toc-monotone-likelihood-for-alpha" class="nav-link" data-scroll-target="#monotone-likelihood-for-alpha">Monotone likelihood for <span class="math inline">\(\alpha\)</span></a></li>
  <li><a href="#introducing-penalization-for-alpha" id="toc-introducing-penalization-for-alpha" class="nav-link" data-scroll-target="#introducing-penalization-for-alpha">Introducing penalization for <span class="math inline">\(\alpha\)</span></a></li>
  <li><a href="#introducing-penalization-for-alpha-1" id="toc-introducing-penalization-for-alpha-1" class="nav-link" data-scroll-target="#introducing-penalization-for-alpha-1">Introducing penalization for <span class="math inline">\(\alpha\)</span></a></li>
  <li><a href="#paramter-estimates" id="toc-paramter-estimates" class="nav-link" data-scroll-target="#paramter-estimates">Paramter estimates</a></li>
  <li><a href="#estimated-mda-impact-function" id="toc-estimated-mda-impact-function" class="nav-link" data-scroll-target="#estimated-mda-impact-function">Estimated MDA impact function</a></li>
  <li><a href="#prevalence-prediction-2000-2024" id="toc-prevalence-prediction-2000-2024" class="nav-link" data-scroll-target="#prevalence-prediction-2000-2024">Prevalence prediction 2000-2024</a></li>
  <li><a href="#sth-slide" id="toc-sth-slide" class="nav-link" data-scroll-target="#sth-slide">Example: soil-transmitted helminths in Kenya</a></li>
  <li><a href="#the-data-1" id="toc-the-data-1" class="nav-link" data-scroll-target="#the-data-1">The data</a></li>
  <li><a href="#timeline-of-surveys-and-mda-1" id="toc-timeline-of-surveys-and-mda-1" class="nav-link" data-scroll-target="#timeline-of-surveys-and-mda-1">Timeline of surveys and MDA</a></li>
  <li><a href="#paramter-estimates-1" id="toc-paramter-estimates-1" class="nav-link" data-scroll-target="#paramter-estimates-1">Paramter estimates</a></li>
  <li><a href="#the-mda-impact-by-sth-species" id="toc-the-mda-impact-by-sth-species" class="nav-link" data-scroll-target="#the-mda-impact-by-sth-species">The MDA impact by STH species</a></li>
  <li><a href="#prevalence-prediction-2012-2023" id="toc-prevalence-prediction-2012-2023" class="nav-link" data-scroll-target="#prevalence-prediction-2012-2023">Prevalence prediction 2012-2023</a></li>
  <li><a href="#next-steps-and-extenions" id="toc-next-steps-and-extenions" class="nav-link" data-scroll-target="#next-steps-and-extenions">Next steps and extenions</a></li>
  <li><a href="#thank-you" id="toc-thank-you" class="nav-link" data-scroll-target="#thank-you">THANK YOU!</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Lund2025.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Accounting for the impact of mass-drug administration for NTDs prevalence mapping using geostatistical methods</h1>
<p class="subtitle lead">A decay-adjusted spatio-temporal (DAST) model</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Emanuele Giorgi, Claudio Fronterre, Jana Purkiss, Freya Clark </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Lancaster University
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<section id="presentation-overview" class="level2">
<h2 class="anchored" data-anchor-id="presentation-overview">Presentation Overview</h2>
<ol type="1">
<li><strong>Neglected Tropical Diseases and Mass Drug Administration</strong></li>
<li><strong>The standard geostatistical model for prevalence mapping</strong></li>
<li><strong>A decay-adjusted spatio-temporal model</strong></li>
<li><strong>Application to lymphatic filariasis in Madagascar</strong></li>
<li><strong>Summary</strong></li>
</ol>
<hr>
</section>
<section id="neglected-tropical-diseases" class="level2">
<h2 class="anchored" data-anchor-id="neglected-tropical-diseases">Neglected tropical diseases</h2>
<p><img src="figures/Figure-12.png" class="img-fluid"></p>
</section>
<section id="ntd-endemic-areas" class="level2">
<h2 class="anchored" data-anchor-id="ntd-endemic-areas">NTD endemic areas</h2>
<p><img src="figures/Prevalence-of-neglected-tropical-diseases-NTDs-by-country-The-burden-of-NTDs-in_W640.jpg" class="img-fluid"></p>
</section>
<section id="the-impact-of-ntds" class="level2">
<h2 class="anchored" data-anchor-id="the-impact-of-ntds">The impact of NTDs</h2>
<p><img src="figures/Ranking-of-NTDs-by-Disease-Burden-DALYs-and-Comparison-with-HIV-AIDS-Tuberculosis-and.png" class="img-fluid" style="width:35.0%"></p>
</section>
<section id="ntds-risk-factors" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="ntds-risk-factors">NTDs Risk Factors</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="figures/D200-0790-138A-2.jpg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="figures/Five-Diseases-That-Thrive-in-Poor-Sanitation.jpg" class="img-fluid"></p>
</div>
</div>
</div>
<p><strong>Common risk factors:</strong><br>
- Poor sanitation and lack of clean water<br>
- Limited healthcare access<br>
- Poverty and overcrowding<br>
- Exposure to disease vectors (e.g., mosquitoes, flies)<br>
- Lack of education and awareness</p>
</section>
<section id="mass-drug-administration-mda-a-preventive-strategy" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="mass-drug-administration-mda-a-preventive-strategy">Mass Drug Administration (MDA): A Preventive Strategy</h2>
<p><strong>What is MDA?</strong> Mass Drug Administration involves the periodic distribution of safe, effective medications to <strong>entire at-risk populations</strong>‚Äîregardless of disease status‚Äîto reduce transmission and prevent infections.</p>
<p>. . .</p>
<p><strong>Why is it used?</strong></p>
<ul>
<li><p>Controls or eliminates disease in endemic areas</p></li>
<li><p>Reduces the community-level parasite burden</p></li>
<li><p>Prevents long-term complications and disability</p></li>
</ul>
<p>. . .</p>
<p><strong>Key Features:</strong></p>
<ul>
<li><p>Delivered at regular intervals (annually or biannually)</p></li>
<li><p>Often combined with public health education</p></li>
<li><p>Supported by WHO and major global health initiatives</p></li>
</ul>
</section>
<section id="albendazole" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="albendazole">Albendazole</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<p><img src="figures/albe.jpg" class="img-fluid"></p>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<p><strong>How it works:</strong><br>
Albendazole disrupts the metabolism of parasitic worms by inhibiting microtubule formation, which is essential for their survival.</p>
<div class="notes">
<p>Albendazole works by stopping worms from absorbing the nutrients they need to survive. It blocks a process inside their cells that‚Äôs kind of like the framework or ‚Äúskeleton‚Äù that helps them function and grow. Without it, the worms can‚Äôt live for long and are eventually cleared from the body.</p>
</div>
<p><strong>Used for NTDs such as:</strong></p>
<ul>
<li><p>Lymphatic filariasis (in combination with ivermectin or DEC)</p></li>
<li><p>Soil-transmitted helminths (e.g., ascariasis, hookworm, trichuriasis)</p></li>
</ul>
<p><strong>MDA use:</strong><br>
Distributed in large-scale deworming campaigns, particularly targeting children and at-risk communities.</p>
</div>
</div>
</div>
</section>
<section id="ivermectin" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="ivermectin">Ivermectin</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<p><img src="figures/ivermectin.jpg" class="img-fluid"></p>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<p><strong>How it works:</strong></p>
<p>Ivermectin paralyzes and kills parasites by interfering with their nerve and muscle function via chloride channel disruption. Parasites cannot move and feed.</p>
<div class="notes">
<p><strong>Ivermectin kills parasites by messing with their nerves and muscles, which causes them to become paralyzed and die.</strong> It stops them from moving and feeding, so the body can get rid of them.</p>
<p>Chloride channel disruption refers to any impairment in the normal function of chloride channels, which are protein pores in cell membranes that allow chloride ions (Cl-) to pass through.</p>
</div>
<p><strong>Used for NTDs such as:</strong></p>
<ul>
<li><p>Onchocerciasis (river blindness)<br>
</p></li>
<li><p>Lymphatic filariasis (in combination with albendazole)<br>
</p></li>
<li><p>Strongyloidiasis</p></li>
</ul>
<p><strong>MDA use:</strong> Ivermectin is given to both adults and children (weighing more than 15kg), but its use is carefully considered for pregnant women.</p>
</div>
</div>
</div>
</section>
<section id="praziquantel" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="praziquantel">Praziquantel</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<p><img src="figures/praz.jpg" class="img-fluid"></p>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<p><strong>How it works:</strong><br>
Praziquantel increases permeability of the parasite‚Äôs cell membranes to calcium ions, causing muscle contraction and paralysis.</p>
<div class="notes">
<p>Praziquantel makes the outer layer of the parasite‚Äôs cells more ‚Äúleaky,‚Äù allowing calcium to enter. This causes the parasite‚Äôs muscles to tighten and paralyze it, making it easier for the body to get rid of it.</p>
<p>Inside the cells of parasites, calcium is important for controlling muscle movement. When calcium enters the parasite‚Äôs cells (which normally isn‚Äôt supposed to happen), it disrupts the normal function of the muscles.</p>
<p>This excess calcium makes the muscles contract and become stiff. The parasite can‚Äôt move properly or feed, and it becomes paralyzed, which allows the body to get rid of it. So, calcium causes the parasite‚Äôs muscles to freeze up, stopping it from surviving or causing further harm.</p>
</div>
<p><strong>Used for NTDs such as:</strong><br>
</p>
<ul>
<li><p>Schistosomiasis<br>
</p></li>
<li><p>Tapeworm infections</p></li>
</ul>
<p><strong>MDA use:</strong><br>
Key drug in school-based and community-wide treatment campaigns in regions with high schistosomiasis burden.</p>
</div>
</div>
</div>
</section>
<section id="treating-ntds" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="treating-ntds">Treating NTDs</h2>
<div class="cell" data-tbl-width="compact">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Disease</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Alb</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">PZQ</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">IVM</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">AZM</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">DEC</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">MOX</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">STH</td>
<td style="text-align: center;">‚úì</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">MBD</td>
</tr>
<tr class="even">
<td style="text-align: center;">Schisto</td>
<td style="text-align: center;">‚úì‚Ä†</td>
<td style="text-align: center;">‚úì</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">OXA</td>
</tr>
<tr class="odd">
<td style="text-align: center;">LF</td>
<td style="text-align: center;">‚úì‚Ä†</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">‚úì</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">‚úì</td>
<td style="text-align: center;">‚úì</td>
<td style="text-align: center;">DOX*</td>
</tr>
<tr class="even">
<td style="text-align: center;">Trachoma</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">‚úì‚Ä°</td>
<td style="text-align: center;">‚úì</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">TEO</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>Abbreviations:</strong></p>
<p>Alb = Albendazole, PZQ = Praziquantel, IVM = Ivermectin, AZM = Azithromycin, DEC = Diethylcarbamazine, MOX = Moxidectin, MBD = Mebendazole, OXA = Oxamniquine, DOX = Doxycycline, TEO = Tetracycline eye ointment</p>
<p><strong>Symbols:</strong></p>
<p>‚Ä† Used in combination therapy</p>
<p>‚Ä° Only in onchocerciasis co-endemic areas</p>
<p>*Adjunctive treatment</p>
<div class="notes">
<p><strong>Key Explanations:</strong> - <strong>combo</strong>: Combination therapy enhances efficacy (e.g., albendazole+praziquantel for schistosomiasis kills both juvenile and adult worms)</p>
<ul>
<li><strong>co-endemic areas only</strong> (trachoma/ivermectin):
<ul>
<li>Ivermectin is only recommended for trachoma in areas where onchocerciasis (river blindness) is also present because:
<ol type="1">
<li><strong>In onchocerciasis-endemic areas</strong>: Mass ivermectin distribution is already occurring for river blindness control, so it can simultaneously help reduce trachoma transmission</li>
<li><strong>In non-onchocerciasis areas</strong>:
<ul>
<li>Azithromycin is preferred as the primary trachoma treatment because:
<ul>
<li>It has direct antibacterial action against Chlamydia trachomatis</li>
<li>Better safety profile for children and pregnant women</li>
<li>Additional community-wide benefits against other bacterial infections</li>
</ul></li>
<li>Ivermectin isn‚Äôt contraindicated, but simply less optimal than azithromycin for trachoma-specific control</li>
</ul></li>
</ol></li>
</ul></li>
<li><strong>adjunct</strong>:
<ul>
<li>Secondary treatment that supports but doesn‚Äôt replace primary therapy</li>
<li>Example: Doxycycline for LF kills Wolbachia bacteria inside adult worms, making them sterile (used alongside albendazole/ivermectin)</li>
</ul></li>
</ul>
</div>
</section>
<section id="assessing-mda-impact" class="level2 smaller scrollable">
<h2 class="smaller scrollable anchored" data-anchor-id="assessing-mda-impact">Assessing MDA Impact</h2>
<p><strong>Timeframe for observable impact:</strong></p>
<ul>
<li><p>STH: Reduced prevalence seen after 1-2 annual rounds</p></li>
<li><p>Schistosomiasis: Egg reduction visible after 1-2 years</p></li>
<li><p>LF: Microfilariae reduction within months, but breaking transmission requires 5+ years</p></li>
<li><p>Trachoma: Active disease reduction in 1-3 years</p></li>
</ul>
<p><strong>Monitoring surveys:</strong></p>
<ul>
<li><p>Baseline surveys (pre-MDA)</p></li>
<li><p>Transmission Assessment Surveys (TAS) for LF after 5+ rounds</p></li>
<li><p>Impact surveys (after 3-5 rounds)</p></li>
<li><p>Post-treatment surveillance (after reaching elimination targets)</p></li>
</ul>
<p><strong>Key indicators:</strong></p>
<ul>
<li><p>Parasitological prevalence (STH, schisto)</p></li>
<li><p>Antigenemia (LF)</p></li>
<li><p>TF/TI rates (trachoma)</p></li>
<li><p>Entomological indices (for vector-borne NTDs)</p></li>
</ul>
</section>
<section id="modelling-the-impact-of-mda" class="level2">
<h2 class="anchored" data-anchor-id="modelling-the-impact-of-mda">Modelling the impact of MDA</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lund2025_files/figure-revealjs/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-standard-geostatistical-model-for-prevalence-mapping" class="level2 scrollable smaller">
<h2 class="scrollable smaller anchored" data-anchor-id="the-standard-geostatistical-model-for-prevalence-mapping">The standard geostatistical model for prevalence mapping</h2>
<ul>
<li><strong>Outcome</strong>: <span class="math inline">\(Y_i\)</span> number of cases out <span class="math inline">\(n_i\)</span> sampled</li>
</ul>
<p>. . .</p>
<ul>
<li><strong>Locations</strong>: <span class="math inline">\(X = (x_1, \ldots, x_n)\)</span></li>
</ul>
<p>. . .</p>
<ul>
<li><strong>Covariates</strong> (optional): <span class="math inline">\(d(x)\)</span> (e.g.&nbsp;elevation, distance from waterways)</li>
</ul>
<p>. . .</p>
<ul>
<li><strong>Spatial Gaussian process</strong>: <span class="math inline">\(S(x)\)</span> (stationary and isotropic) <span class="math display">\[
{\rm cov}\{S(x), S(x')\} = \sigma^2 \rho(||x - x'||; \phi)
\]</span> Example: <span class="math inline">\(\rho(u; \phi) = \exp\{-u/\phi\}\)</span>.</li>
</ul>
<p>. . .</p>
<ul>
<li><strong>Conditional independence</strong>: <span class="math inline">\(Y_{i}\)</span> conditionally on <span class="math inline">\(S(x_i)\)</span> are mutually independent <span class="math inline">\(Bin(n_i , p(x_i))\)</span></li>
</ul>
<p>. . .</p>
<ul>
<li>The <strong>linear predictor</strong> <span class="math display">\[
\log\left\{\frac{p(x_i)}{1-p(x_i)}\right\} = \beta_0 + d(x_i)^\top \beta + S(x_i)
\]</span></li>
</ul>
</section>
<section id="spatial-and-temporal-confounding-with-mda" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="spatial-and-temporal-confounding-with-mda">Spatial and temporal confounding with MDA</h2>
<center>
<img src="figures/scenario_surveys.png" class="img-fluid">
</center>
<p><strong>Issues:</strong></p>
<ul>
<li><p>Areas with different levels of transmission are sampled at different times.</p></li>
<li><p>Use of MDA rounds can even show a positive associated with disease risk</p></li>
</ul>
</section>
<section id="modelling-the-impact-of-mda-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="modelling-the-impact-of-mda-1">Modelling the Impact of MDA</h2>
<p>We model observed prevalence <span class="math inline">\(P(x,t)\)</span> as a product of:</p>
<ul>
<li><strong>Counterfactual prevalence</strong>, <span class="math inline">\(P^*(x,t)\)</span>, in the absence of MDA</li>
<li>A <strong>cumulative MDA effect</strong>, based on rounds of effective treatment</li>
</ul>
<p><span class="math display">\[
P(x, t) = P^*(x, t)\prod_{j=1}^{r(t)} \left[1 - f(t - u_j)\right]^{I(x, u_j)}
\]</span></p>
<ul>
<li><span class="math inline">\(u_j\)</span>: times of effective MDA rounds<br>
</li>
<li><span class="math inline">\(I(x, u_j)\)</span>: indicator of MDA coverage at location <span class="math inline">\(x\)</span> and time <span class="math inline">\(u_j\)</span></li>
<li><span class="math inline">\(r(t)\)</span> is the number of MDA rounds carried out before time <span class="math inline">\(t\)</span></li>
</ul>
</section>
<section id="parametric-form-of-mda-decay-function" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="parametric-form-of-mda-decay-function">Parametric form of MDA decay function</h2>
<p><span class="math display">\[
f(v) = \alpha \exp\left\{ -\left(\frac{v}{\gamma}\right)^{\kappa} \right\}
\]</span></p>
<ul>
<li><span class="math inline">\(\alpha\)</span>: maximum reduction immediately after MDA<br>
</li>
<li><span class="math inline">\(\gamma\)</span>: scale of decay<br>
</li>
<li><span class="math inline">\(\kappa\)</span>: shape of decay (fixed)</li>
</ul>
<center>
<img src="figures/f_mda.jpg" class="img-fluid" style="width:40.0%">
</center>
</section>
<section id="monte-carlo-maximum-likelihood" class="level2 smaller scrollable">
<h2 class="smaller scrollable anchored" data-anchor-id="monte-carlo-maximum-likelihood">Monte Carlo Maximum Likelihood</h2>
<ul>
<li>Let <span class="math inline">\(W_i = S(x_i) + Z_i\)</span> and <span class="math inline">\(W = (W_1, \ldots, W_n)\)</span></li>
</ul>
<p>. . .</p>
<ul>
<li><p>The likelihood function for parameters <span class="math inline">\(\theta = (\beta, \sigma^2, \phi, \tau^2)\)</span> is given by:</p>
<p><span class="math display">\[
L(\theta) = \int N(W; D\beta, \Omega) f(y| W) dW
\]</span></p>
<p>where <span class="math inline">\(\Omega = \sigma^2 R(\phi) + \tau^2I_n\)</span>.</p></li>
</ul>
<p>. . .</p>
<ul>
<li><p>We approximate this using Monte Carlo integration:</p>
<p><span class="math display">\[
L_m(\theta) = \frac{1}{B} \sum_{j=1}^{B} \frac{N\left(W^{(j)}; D\beta, \Omega \right)}{N\left(W^{(j)}; D\beta_0, \Omega_0\right)}
\]</span> where <span class="math inline">\(W^{(i)}\)</span> are sampled from the distribution of <span class="math inline">\(W\)</span> given <span class="math inline">\(y\)</span> using an MCMC algorithm.</p></li>
<li><p>All implemented in the <code>dast</code> function of the <code>RiskMap</code> package <img src="figures/excitement.png" width="80" height="80" style="vertical-align: middle;"></p></li>
</ul>
</section>
<section id="applications" class="level2">
<h2 class="anchored" data-anchor-id="applications">Applications</h2>
<ul>
<li><p><a href="#lf-slide">Lymphatic filariasis in Madagascar</a></p></li>
<li><p><a href="#sth-slide">Soil-transmitted helminths in Kenya</a></p></li>
</ul>
</section>
<section id="lf-slide" class="level2">
<h2 class="anchored" data-anchor-id="lf-slide">Example: Lymphatic filariasis in Madagascar</h2>
<center>
<img src="figures/lf.png" class="img-fluid" style="width:60.0%">
</center>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">The data</h2>
<div style="width: 100%; height: 900px; position: relative;">
<iframe src="lf_madagascar.html" width="100%" height="70%" style="border: none; position: absolute; top: 0; left: 0;">
</iframe>
</div>
</section>
<section id="timeline-of-surveys-and-mda" class="level2">
<h2 class="anchored" data-anchor-id="timeline-of-surveys-and-mda">Timeline of surveys and MDA</h2>
<center>
<img src="figures/mdg_data.png" class="img-fluid" style="width:55.0%">
</center>
</section>
<section id="monotone-likelihood-for-alpha" class="level2">
<h2 class="anchored" data-anchor-id="monotone-likelihood-for-alpha">Monotone likelihood for <span class="math inline">\(\alpha\)</span></h2>
<center>
<img src="figures/profile_alpha.jpg" class="img-fluid" style="width:50.0%">
</center>
</section>
<section id="introducing-penalization-for-alpha" class="level2 smaller scrollable">
<h2 class="smaller scrollable anchored" data-anchor-id="introducing-penalization-for-alpha">Introducing penalization for <span class="math inline">\(\alpha\)</span></h2>
<ul>
<li>Let <span class="math inline">\(p(\alpha) &gt; 0\)</span> be a positive function.</li>
</ul>
<p>. . .</p>
<ul>
<li>The penalized likelihood for <span class="math inline">\(\alpha\)</span> is <span class="math display">\[
L_{p}(\theta) = L(\theta) - p(\alpha)
\]</span></li>
</ul>
<p>. . .</p>
<ul>
<li><p>Proposed penalty</p>
<p><span class="math display">\[
p(\alpha) = -\left[\lambda_1 \log\alpha + \lambda_2\log(1-\alpha) \right]
\]</span></p></li>
</ul>
<p>. . .</p>
<ul>
<li>We set <span class="math inline">\(\lambda_1 = 20\)</span> and <span class="math inline">\(\lambda_2 = 14\)</span>. (This inspired by a Beta distribution with mode in around 0.6, with 0.42 and 0.7 as its 0.025 and 0.975 quantiles, respectively.)</li>
</ul>
<center>
<img src="figures/beta_distr.png" class="img-fluid" style="width:40.0%">
</center>
</section>
<section id="introducing-penalization-for-alpha-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="introducing-penalization-for-alpha-1">Introducing penalization for <span class="math inline">\(\alpha\)</span></h2>
<center>
<img src="figures/penalized_profile_alpha.jpg" class="img-fluid" style="width:50.0%">
</center>
</section>
<section id="paramter-estimates" class="level2">
<h2 class="anchored" data-anchor-id="paramter-estimates">Paramter estimates</h2>
<p>MDA impact function: <span class="math inline">\(f(v) = \alpha\exp\{-v/\gamma\}\)</span>, with <span class="math inline">\(v\)</span> denoting the years since last MDA</p>
<p>. . .</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Parameter</th>
<th>Estimates</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercept</td>
<td>-2.582 (-2.622, -2.541)</td>
</tr>
<tr class="even">
<td>Spatial variance</td>
<td>2.204 (1.891, 2.569)</td>
</tr>
<tr class="odd">
<td>Spatial scale</td>
<td>79.153 (70.874, 88.399)</td>
</tr>
<tr class="even">
<td>Max. reduction (<span class="math inline">\(\alpha\)</span>)</td>
<td>0.856 (0.839, 0.872)</td>
</tr>
<tr class="odd">
<td>Decay scale (<span class="math inline">\(\gamma\)</span>)</td>
<td>1.802 (1.768, 1.837)</td>
</tr>
</tbody>
</table>
</section>
<section id="estimated-mda-impact-function" class="level2">
<h2 class="anchored" data-anchor-id="estimated-mda-impact-function">Estimated MDA impact function</h2>
<center>
<img src="figures/mdg_mda_f.png" class="img-fluid">
</center>
</section>
<section id="prevalence-prediction-2000-2024" class="level2">
<h2 class="anchored" data-anchor-id="prevalence-prediction-2000-2024">Prevalence prediction 2000-2024</h2>
<center>
<img src="figures/prevalence_animation.gif" class="img-fluid">
</center>
</section>
<section id="sth-slide" class="level2">
<h2 class="anchored" data-anchor-id="sth-slide">Example: soil-transmitted helminths in Kenya</h2>
<center>
<img src="figures/sth_cycle.jpg" class="img-fluid">
</center>
</section>
<section id="the-data-1" class="level2">
<h2 class="anchored" data-anchor-id="the-data-1">The data</h2>
<div style="width: 100%; height: 900px; position: relative;">
<iframe src="sth_kenya.html" width="100%" height="70%" style="border: none; position: absolute; top: 0; left: 0;">
</iframe>
</div>
</section>
<section id="timeline-of-surveys-and-mda-1" class="level2">
<h2 class="anchored" data-anchor-id="timeline-of-surveys-and-mda-1">Timeline of surveys and MDA</h2>
<center>
<img src="figures/kenya_data.png" class="img-fluid" style="width:55.0%">
</center>
</section>
<section id="paramter-estimates-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="paramter-estimates-1">Paramter estimates</h2>
<p>MDA impact function: <span class="math inline">\(f(v) = \alpha\exp\{-v/\gamma\}\)</span>, with <span class="math inline">\(v\)</span> denoting the years since last MDA</p>
<p>. . .</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Ascaris</th>
<th>Trichuris</th>
<th>Hookworm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Intercept</strong></td>
<td>-2.41 (-2.45, -2.37)</td>
<td>-2.44 (-2.51, -2.37)</td>
<td>-1.94 (-1.98, -1.90)</td>
</tr>
<tr class="even">
<td><strong>Spatial variance</strong></td>
<td>26.83 (14.70, 48.97)</td>
<td>15.57 (8.35, 29.06)</td>
<td>29.75 (20.17, 43.89)</td>
</tr>
<tr class="odd">
<td><strong>Spatial scale</strong></td>
<td>263.31 (178.38, 388.66)</td>
<td>109.02 (72.34, 164.32)</td>
<td>198.63 (152.33, 258.99)</td>
</tr>
<tr class="even">
<td><strong>Max. reduction (<span class="math inline">\(\alpha\)</span>)</strong></td>
<td>0.318 (0.299, 0.338)</td>
<td>0.837 (0.533, 0.958)</td>
<td>0.892 (0.871, 0.909)</td>
</tr>
<tr class="odd">
<td><strong>Decay scale (<span class="math inline">\(\gamma\)</span>)</strong></td>
<td>9.49 (7.41, 12.16)</td>
<td>1.23 (1.01, 1.49)</td>
<td>6.46 (6.06, 6.90)</td>
</tr>
</tbody>
</table>
</section>
<section id="the-mda-impact-by-sth-species" class="level2">
<h2 class="anchored" data-anchor-id="the-mda-impact-by-sth-species">The MDA impact by STH species</h2>
<center>
<img src="figures/MDA_effects.png" class="img-fluid">
</center>
</section>
<section id="prevalence-prediction-2012-2023" class="level2">
<h2 class="anchored" data-anchor-id="prevalence-prediction-2012-2023">Prevalence prediction 2012-2023</h2>
<center>
<img src="figures/STH_grid_animation.gif" class="img-fluid" style="width:75.0%">
</center>
<center>
<img src="figures/STH_sc_animation.gif" class="img-fluid" style="width:75.0%">
</center>
</section>
<section id="next-steps-and-extenions" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="next-steps-and-extenions">Next steps and extenions</h2>
<ul>
<li><p>Need for extension that includes <span class="math inline">\(S(x,t)\)</span> rather than <span class="math inline">\(S(x)\)</span>.</p></li>
<li><p>Apply DAST to other NTDs.</p></li>
<li><p>Key assumptions of DAST</p>
<ul>
<li><p>The MDA effect is the same across time</p></li>
<li><p>Incorporating data from multiple diagnostics</p></li>
<li><p>Accounting for the effect of different types of treatments</p></li>
<li><p>Uncertainty in the MDA coverage</p></li>
</ul></li>
</ul>
</section>
<section id="thank-you" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="thank-you">THANK YOU!</h2>
<center>
<img src="figures/questions.jpg" style="height:4in">
</center>
<p>üîó <a href="https://giorgistat.github.io">giorgistat.github.io</a><br>
üìß e.giorgi@lancaster.ac.uk<br>
üìç CHICAS, Lancaster Medical School, Lancaster University, UK</p>


</section>

</main> <!-- /main -->

<script>
  // htmlwidgets need to know to resize themselves when slides are shown/hidden.
  // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
  // slide changes (different for each slide format).
  (function () {
    // dispatch for htmlwidgets
    function fireSlideEnter() {
      const event = window.document.createEvent("Event");
      event.initEvent("slideenter", true, true);
      window.document.dispatchEvent(event);
    }

    function fireSlideChanged(previousSlide, currentSlide) {
      fireSlideEnter();

      // dispatch for shiny
      if (window.jQuery) {
        if (previousSlide) {
          window.jQuery(previousSlide).trigger("hidden");
        }
        if (currentSlide) {
          window.jQuery(currentSlide).trigger("shown");
        }
      }
    }

    // hookup for slidy
    if (window.w3c_slidy) {
      window.w3c_slidy.add_observer(function (slide_num) {
        // slide_num starts at position 1
        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
      });
    }

  })();
</script>

<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/giorgistat\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>