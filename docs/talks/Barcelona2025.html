<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.33">

  <meta name="author" content="Emanuele Giorgi">
  <meta name="author" content="Jonas Wallin">
  <title>Welcome to My Personal Website ‚Äì A flexible class of latent variable models for the analysis of antibody response data</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-8a5cdbf101a0845817b98f2425171703.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">A flexible class of latent variable models for the analysis of antibody response data</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Emanuele Giorgi 
</div>
        <p class="quarto-title-affiliation">
            University of Birmingham
          </p>
    </div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Jonas Wallin 
</div>
        <p class="quarto-title-affiliation">
            Lund University
          </p>
    </div>
</div>

</section>
<section id="presentation-overview" class="slide level2">
<h2>Presentation Overview</h2>
<ol type="1">
<li><strong>A brief overview of the serology</strong></li>
<li><strong>Current approaches for the analysis of antibody data</strong></li>
<li><strong>The proposed modelling approach</strong></li>
<li><strong>Application to malaria sero-epidemiology</strong></li>
<li><strong>Summary</strong></li>
</ol>
</section>
<section id="key-definitions" class="slide level2">
<h2>Key definitions</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><p><strong>Antigen</strong><br>
A molecule (often a protein or polysaccharide) from a pathogen that is recognized by the immune system and can trigger an immune response.</p></li>
<li><p><strong>Antibody</strong><br>
A protein produced by B cells that specifically binds to an antigen, reflecting current or past exposure to the pathogen.</p></li>
</ul>
</div><div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/antib_antig.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div></div>
</section>
<section id="immune-response-to-infectious-diseases" class="slide level2">
<h2>Immune response to infectious diseases</h2>

<img data-src="figures/antib_covid.jpg" class="quarto-figure quarto-figure-center r-stretch" data-out-width="90%"><aside class="notes">
<p>Following infection, the adaptive immune response is initiated through antigen recognition by na√Øve B cells. Different classes of antibodies play distinct roles in this process. IgM is usually the first antibody produced following infection and reflects recent or ongoing exposure, but is short-lived. IgG is produced later, after immune maturation and class switching, and persists substantially longer, providing a durable marker of past exposure. Other antibody classes, such as IgA and IgE, play important biological roles but are less commonly used in sero-epidemiological studies.</p>
<p>The initiation of the adaptive immune response is not immediate, introducing a delay between pathogen entry and measurable antibody responses. During the incubation period, the pathogen replicates while innate immune mechanisms dominate early control. Antigen processing and presentation occur during this phase, and B-cell activation begins, but IgG antibodies are typically not yet detectable, creating a systematic lag between infection onset and serological evidence of exposure.</p>
<p>As infection progresses into the early symptomatic phase, short-lived antibody classes, particularly IgM, start to rise. At the same time, class-switch recombination is initiated and IgG production begins, although IgG levels remain relatively low. For this reason, IgG-based assays often have limited sensitivity very early in the course of disease.</p>
<p>During the peak symptomatic phase, or shortly thereafter, antigen levels decline as immune control is established. Plasma cells produce increasing quantities of IgG, leading to a rapid rise in IgG levels, which typically peak around or shortly after symptom resolution. The timing and magnitude of this peak depend on pathogen characteristics, infection intensity, and host immune status.</p>
<p>In the recovery and convalescent phase, IgM wanes rapidly, while IgG declines much more slowly, often following an approximately exponential decay. Long-lived plasma cells and memory B cells maintain persistent IgG titres, which may remain detectable for months or years. Subsequent exposure or reinfection usually results in faster and stronger boosting of IgG, compared with the primary response.</p>
<p>Because of this delayed but durable behaviour, IgG provides an integrated record of infection history, rather than a snapshot of current infection. This makes IgG the most commonly measured antibody isotype in sero-epidemiology.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="footer">
<p>Denning DW, Kilcoyne A, Ucer C (2020). <em>Non-infectious status indicated by detectable IgG antibody to SARS-CoV-2</em>.<br>
<strong>British Dental Journal</strong>, 229:521‚Äì524. <a href="https://www.nature.com/articles/s41415-020-2228-9">Link to article</a></p>
</div>
</section>
<section id="when-are-igg-responses-informative" class="slide level2">
<h2>When are IgG responses informative?</h2>
<div style="font-size:0.75em; line-height:1.15;">
<ul>
<li><p>Infections with many <strong>asymptomatic</strong> cases<br>
malaria, dengue, chikungunya, Zika</p></li>
<li><p>Acute infections with <strong>short diagnostic windows</strong><br>
SARS-CoV-2, influenza, yellow fever</p></li>
<li><p>Diseases with <strong>repeated or cumulative exposure</strong><br>
malaria, schistosomiasis, soil-transmitted helminths, onchocerciasis</p></li>
<li><p><strong>Chronic</strong> infection or <strong>elimination</strong> settings<br>
trachoma, lymphatic filariasis, onchocerciasis</p></li>
<li><p><u>Not informative</u> when <strong>cell-mediated</strong> immunity is dominant<br>
tuberculosis, leishmaniasis</p></li>
</ul>
</div>
<aside class="notes">
<p>IgG responses are most informative in settings where infection history cannot be reliably reconstructed from clinical or diagnostic data alone.</p>
<p>Infections with a high proportion of asymptomatic or mildly symptomatic cases, such as malaria, dengue, chikungunya and Zika, are poorly captured by routine surveillance. In these contexts, IgG provides a cumulative record of past exposure at both individual and population levels.</p>
<p>IgG is also valuable for acute infections with short diagnostic windows, such as SARS-CoV-2, influenza and yellow fever, where molecular or antigen-based detection is only possible for a limited period. Persisting IgG allows retrospective assessment of transmission.</p>
<p>Diseases characterised by repeated or ongoing exposure, such as malaria, schistosomiasis, soil-transmitted helminths and onchocerciasis, are another important application. Here, IgG levels integrate multiple infection events and can be informative about long-term transmission intensity rather than single episodes.</p>
<p>IgG responses are also widely used in chronic infections and in elimination or near-elimination settings, such as trachoma and lymphatic filariasis, where clinical cases become rare but evidence of residual transmission is still required.</p>
<p>However, there are important contexts where IgG is less informative. For infections that induce weak or short-lived systemic antibody responses, particularly some enteric bacterial infections such as cholera or non-typhoidal Salmonella, IgG levels may not reliably reflect exposure.</p>
<p>IgG is also less informative for diseases in which immunity is primarily cell-mediated rather than antibody-mediated, or where circulating IgG does not correlate well with protection or recent transmission, limiting its interpretability without additional modelling.</p>
<p>In interpreting serological data, it is useful to contrast antibody-mediated and cell-mediated immunity. Antibody-mediated, or humoral, immunity is driven by circulating antibodies such as IgM and IgG, which target pathogens or antigens present in the blood or other extracellular spaces. For this reason, antibody responses are particularly useful for population surveillance, for reconstructing exposure history, and for epidemiological inference based on serology. By contrast, cell-mediated immunity acts primarily through T cells that recognise and destroy infected host cells. In diseases where immune control relies predominantly on these cellular mechanisms, circulating antibody levels may provide only limited information about infection status or protection, and are therefore often poorly captured by serology alone.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="seropositivity-and-seronegativity" class="slide level2 smaller">
<h2>Seropositivity and seronegativity</h2>
<div style="font-size:1em; line-height:1.15;">
<ul>
<li><p><strong>Seronegativity</strong><br>
Absence of detectable antibody response to a given antigen.</p></li>
<li><p><strong>Seropositivity</strong><br>
Antibody concentration exceeding a predefined assay-specific threshold, interpreted as evidence of prior exposure or immunity.</p></li>
</ul>
<p><strong>Common approaches to serostatus classification</strong></p>
<ul>
<li>Manufacturer-defined assay cut-offs<br>
</li>
<li>Thresholds based on negative controls<br>
(e.g.&nbsp;mean <span class="math inline">\(+\)</span> 2 or 3 SDs)<br>
</li>
<li>ROC-based cut-offs using known positive/negative samples<br>
</li>
<li>Immunological correlates of protection (when available)<br>
</li>
<li>Data-driven thresholds via finite mixture models</li>
</ul>
</div>
<aside class="notes">
<p>Here I want to briefly clarify what we mean by seropositivity and how it is typically defined in practice.</p>
<p>The most common approach relies on <strong>manufacturer-provided cut-offs</strong>, which are often derived under laboratory conditions and may not translate well to field settings or different epidemiological contexts.</p>
<p>Another widely used method is based on <strong>negative controls</strong>, for example defining seropositivity as antibody levels exceeding the mean of a presumed negative population by two or three standard deviations. This is simple and reproducible, but it depends critically on having a truly unexposed reference group, which is often difficult to identify.</p>
<p>When well-characterised positive and negative samples are available, researchers sometimes use <strong>ROC curve analysis</strong> to choose a cut-off that optimises sensitivity and specificity. This approach is statistically principled, but again depends on the availability and representativeness of validation samples. (ROC-based cut-offs require reference samples with assumed known status. Positive samples usually come from PCR- or clinically confirmed cases, often biased toward recent or symptomatic infections. Negative samples typically come from presumed unexposed populations, such as blood donors from non-endemic areas or historical sera. A threshold is then chosen to balance sensitivity and specificity along the ROC curve. The limitation is that these reference samples are rarely representative of the full immune spectrum in endemic settings, so ROC cut-offs often fail to capture intermediate or waning antibody responses.)</p>
<p>In a few settings, <strong>immunological correlates of protection</strong> are available, meaning that a specific antibody level is known to be associated with clinical protection. These thresholds are biologically meaningful, but they are rare and pathogen-specific.</p>
<p>Finally, many sero-epidemiological studies rely on <strong>finite mixture models</strong>, most commonly Gaussian mixtures, to estimate a data-driven threshold separating seronegative and seropositive subpopulations. This is the approach we focus on next, and it motivates the modelling framework introduced in the following slides.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="antibody-data-and-mixtures" class="slide level2 smaller">
<h2>Antibody data and mixtures</h2>
<div style="font-size:0.9em; line-height:1.15;">
<ul>
<li>Quantitative antibody concentration <span class="math inline">\(Y_i\)</span> (e.g.&nbsp;OD values)<br>
</li>
<li>Classical approach: two-component Gaussian mixture<br>
</li>
<li>Seronegative vs seropositive components</li>
</ul>
<p><span class="math display">\[
f(y) = \pi_0 \mathcal{N}(y ; \mu_0, \sigma_0^2)
     + \pi_1 \mathcal{N}(y ; \mu_1, \sigma_1^2),
\quad \pi_0 + \pi_1 = 1
\]</span></p>
<p><img data-src="figures/antibody_mix.png" style="width:85.0%"></p>
</div>
</section>
<section id="a-latent-variable-of-sero-reactivity" class="slide level2">
<h2>A latent variable of sero-reactivity</h2>
<div style="font-size:0.65em; line-height:1.15; max-height:650px; overflow-y:auto; padding-right:10px;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/seroreactivity.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
<ul>
<li><strong>Sero-reactivity</strong><br>
The presence or degree of antibody reactivity, irrespective of any diagnostic threshold.</li>
</ul>
<ul>
<li class="fragment">Latent variable <span class="math inline">\(T \in [0,1]\)</span> represents the underlying serological activation state:
<ul>
<li class="fragment"><span class="math inline">\(T=0\)</span>: minimal or absent serological activity<br>
</li>
<li class="fragment"><span class="math inline">\(T=1\)</span>: strong or saturated antibody response</li>
</ul></li>
<li class="fragment">Antibody level given latent seroreactivity: <span class="math display">\[
Y \mid T=t \sim
\mathcal{N}\!\big( (1-t)\mu_0 + t\mu_1,\;
                 (1-t)\sigma_0^2 + t\sigma_1^2 \big)
\]</span>
<ul>
<li class="fragment"><span class="math inline">\(\mu_0\)</span>: baseline (no activation)<br>
</li>
<li class="fragment"><span class="math inline">\(\mu_1\)</span>: saturation level<br>
</li>
<li class="fragment"><span class="math inline">\(\sigma_0^2, \sigma_1^2\)</span>: heterogeneity at the two extremes</li>
</ul></li>
</ul>
</div>
</section>
<section id="link-with-antibody-acquisition-models" class="slide level2 smaller">
<h2>Link with antibody acquisition models</h2>
<ul>
<li class="fragment"><p>Classical antibody acquisition model<br>
(<a href="https://www.nature.com/articles/srep19472">Yman et al., 2016</a>) <span class="math display">\[
\mathbb{E}[Y;a] = f(a) = \mu_0 + (\mu_1 - \mu_0)\{1 - \exp(-r a)\},
\]</span> with age <span class="math inline">\(a\)</span> and acquisition rate <span class="math inline">\(r &gt; 0\)</span>.</p></li>
<li class="fragment"><p>Interpretation in the latent sero-reactivity framework <span class="math display">\[
\mathbb{E}[T;a] = \frac{f(a)-\mu_0}{\mu_1-\mu_0}
      = 1 - \exp(-r a),
\]</span></p></li>
<li class="fragment"><p>Resulting expectation of the antibody level <span class="math display">\[
\mathbb{E}[Y;a] = \mu_0 + (\mu_1-\mu_0)\,\mathbb{E}[T;a].
\]</span></p></li>
</ul>
</section>
<section id="how-do-we-model-the-latent-variable-t" class="slide level2 smaller">
<h2>How do we model the latent variable <span class="math inline">\(T\)</span> ?</h2>
<div style="font-size:1em; line-height:1.15;">
<ul>
<li class="fragment"><strong>Single-density approach</strong><br>
The latent sero-reactivity <span class="math inline">\(T \in [0,1]\)</span> is modelled using a single parametric distribution: <span class="math display">\[
T \sim \text{Beta}(\alpha,\beta),
\]</span> where <span class="math inline">\((\alpha,\beta)\)</span> control the mean level of sero-reactivity and its heterogeneity.</li>
<li class="fragment"><strong>Mixture-distribution approach</strong><br>
The latent variable <span class="math inline">\(T\)</span> is modelled as a three-component mixture capturing graded serological states: <span class="math display">\[
T \sim \pi_0\,\text{Beta}(\alpha_0,\beta_0)
   + \pi_1\,\text{Beta}(\alpha_1,\beta_1)
   + \pi_2\,\text{Beta}(\alpha_2,\beta_2),
\]</span> with <span class="math inline">\(\pi_k \ge 0\)</span>, <span class="math inline">\(\sum_{k=0}^2 \pi_k = 1\)</span>, representing low, intermediate, and high sero-reactivity.</li>
</ul>
</div>
</section>
<section id="single-beta-model-for-t" class="slide level2 smaller">
<h2>Single Beta model for <span class="math inline">\(T\)</span></h2>

<img data-src="figures/dens_lbmg.png" class="quarto-figure quarto-figure-center r-stretch" style="width:70.0%"></section>
<section id="how-do-we-model-age-dependency-in-t" class="slide level2 smaller">
<h2>How do we model age dependency in <span class="math inline">\(T\)</span>?</h2>
<div style="font-size:1.15em; line-height:1.15;">
<ul>
<li class="fragment">How should latent sero-reactivity <span class="math inline">\(T\)</span> change with age, reflecting cumulative exposure and immune maturation?</li>
<li class="fragment"><strong>Age-dependent structure</strong><br>
Let the distribution of <span class="math inline">\(T\)</span> depend on age <span class="math inline">\(a\)</span> through parameters or mixing proportions, allowing gradual acquisition.</li>
<li class="fragment">Application to <strong>malaria</strong><br>
Different antigens exhibit distinct age profiles of acquisition and boosting.
<ul>
<li class="fragment">AMA1<br>
Rapid acquisition in early childhood, with sero-reactivity increasing quickly at young ages.</li>
<li class="fragment">MSP1<br>
Slower and more gradual age-related increases, reflecting different exposure or immune dynamics.</li>
</ul></li>
</ul>
</div>
<aside class="notes">
<p>AMA1 and MSP1 are both blood-stage antigens of Plasmodium falciparum, but they differ in their immunological properties and in how antibody responses to them are acquired over age.</p>
<p>Antibodies to AMA1 tend to be acquired relatively quickly after exposure. Even limited exposure early in life often leads to detectable IgG responses, and antibody levels rise steeply with age during early childhood. This makes AMA1 a marker of recent or intense exposure, particularly sensitive to changes in transmission. However, AMA1 responses can also wane relatively quickly in the absence of continued exposure and are known to be boosted strongly by repeated infections.</p>
<p>By contrast, MSP1 antibody responses are typically acquired more gradually. Detectable IgG levels often increase slowly over childhood and adolescence, reflecting cumulative rather than recent exposure. MSP1 responses are therefore often more stable over time and less sensitive to short-term fluctuations in transmission intensity, making them a marker of long-term exposure history.</p>
<p>These differences mean that AMA1 and MSP1 encode different information about transmission. AMA1 is more informative about current or recent transmission, while MSP1 reflects accumulated past exposure. From a modelling perspective, this motivates allowing the age-dependence of latent sero-reactivity to differ by antigen, rather than assuming a common functional form across markers.</p>
<p>In our framework, this translates naturally into antigen-specific age effects on the latent variable T T, capturing faster acquisition for AMA1 and slower, more gradual accumulation for MSP1, without imposing hard sero-positivity thresholds.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="age-dependent-latent-model-for-ama1" class="slide level2 smaller">
<h2>Age-dependent latent model for AMA1</h2>
<div style="font-size:0.85em; line-height:1.15;">
<ul>
<li class="fragment">For age <span class="math inline">\(a&lt;15\)</span> years, <span class="math inline">\(T\)</span> follows a Dirac-Beta mixture: <span class="math display">\[
T \sim (1-\pi(a))\,\delta_0 + \pi(a)\,\mathrm{Beta}(\alpha_2,1), \quad
\pi(a)=1-\exp(-\lambda a).
\]</span></li>
<li class="fragment">For age <span class="math inline">\(a\ge 15\)</span> years, <span class="math inline">\(T\)</span> follows a single Beta with logit-linear mean: <span class="math display">\[
T \sim \mathrm{Beta}\big(\mu(a)\phi,\,[1-\mu(a)]\phi\big), \quad
\log\left\{\frac{\mu(a)}{1-\mu(a)}\right\}=\eta_0+\eta_1\log(a).
\]</span></li>
<li class="fragment">Continuity constraint on the mean of <span class="math inline">\(T\)</span> at <span class="math inline">\(a=15\)</span>: <span class="math display">\[
\eta_0=\mathrm{logit}(\mu_{15^-})-\eta_1\log(15),
\]</span> with <span class="math display">\[
\mu_{15^-}=(1-\exp(-15\lambda))\frac{\alpha_2}{\alpha_2+1}.
\]</span></li>
</ul>
</div>
</section>
<section id="ama1-parameter-estimates" class="slide level2">
<h2>AMA1: parameter estimates</h2>
<table style="font-size:0.65em; line-height:1.15; border-collapse:collapse;">
<thead>
<tr>
<th style="border:none;">
Parameter
</th>
<th style="border:none;">
Estimate
</th>
<th style="border:none;">
SD
</th>
<th style="border:none;">
2.5%
</th>
<th style="border:none;">
50%
</th>
<th style="border:none;">
97.5%
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="6" style="border:none;">
<em>Distribution of Y | T</em>
</td>
</tr>
<tr>
<td style="border:none;">
Œº‚ÇÄ
</td>
<td style="border:none;">
-3.427
</td>
<td style="border:none;">
0.077
</td>
<td style="border:none;">
-3.626
</td>
<td style="border:none;">
-3.470
</td>
<td style="border:none;">
-3.311
</td>
</tr>
<tr>
<td style="border:none;">
Œº‚ÇÅ
</td>
<td style="border:none;">
0.790
</td>
<td style="border:none;">
0.016
</td>
<td style="border:none;">
0.774
</td>
<td style="border:none;">
0.808
</td>
<td style="border:none;">
0.838
</td>
</tr>
<tr>
<td style="border:none;">
œÉ‚ÇÄ
</td>
<td style="border:none;">
0.606
</td>
<td style="border:none;">
0.041
</td>
<td style="border:none;">
0.537
</td>
<td style="border:none;">
0.609
</td>
<td style="border:none;">
0.695
</td>
</tr>
<tr>
<td style="border:none;">
œÉ‚ÇÅ
</td>
<td style="border:none;">
0.114
</td>
<td style="border:none;">
0.022
</td>
<td style="border:none;">
0.077
</td>
<td style="border:none;">
0.122
</td>
<td style="border:none;">
0.164
</td>
</tr>
<tr>
<td colspan="6" style="border:none;">
<em>Distribution of T (age &lt; 15)</em>
</td>
</tr>
<tr>
<td style="border:none;">
Œ±‚ÇÇ
</td>
<td style="border:none;">
1.337
</td>
<td style="border:none;">
0.074
</td>
<td style="border:none;">
1.248
</td>
<td style="border:none;">
1.341
</td>
<td style="border:none;">
1.563
</td>
</tr>
<tr>
<td style="border:none;">
Œª
</td>
<td style="border:none;">
0.224
</td>
<td style="border:none;">
0.032
</td>
<td style="border:none;">
0.173
</td>
<td style="border:none;">
0.227
</td>
<td style="border:none;">
0.299
</td>
</tr>
<tr>
<td colspan="6" style="border:none;">
<em>Distribution of T (age ‚â• 15)</em>
</td>
</tr>
<tr>
<td style="border:none;">
œï
</td>
<td style="border:none;">
3.423
</td>
<td style="border:none;">
0.259
</td>
<td style="border:none;">
3.078
</td>
<td style="border:none;">
3.520
</td>
<td style="border:none;">
4.117
</td>
</tr>
<tr>
<td style="border:none;">
Œ∑‚ÇÅ
</td>
<td style="border:none;">
-0.096
</td>
<td style="border:none;">
0.124
</td>
<td style="border:none;">
-0.399
</td>
<td style="border:none;">
-0.097
</td>
<td style="border:none;">
0.110
</td>
</tr>
</tbody>
</table>
<div style="font-size:0.85em; line-height:1.15;">
<p><em>The estimate of</em> <span class="math inline">\(\lambda\)</span> suggests that on average it takes about 4.5 years for individuals to reach higher levels of sero-reactivity.</p>
</div>
</section>
<section id="ama1-analysis-model-based-histograms" class="slide level2">
<h2>AMA1 analysis: model-based histograms</h2>

<img data-src="figures/joint_ama.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="age-dependent-latent-model-for-msp1" class="slide level2 smaller">
<h2>Age-dependent latent model for MSP1</h2>
<div style="font-size:0.85em; line-height:1.15;">
<ul>
<li>Latent sero-reactivity <span class="math inline">\(T\)</span> follows a single age-dependent Beta distribution: <span class="math display">\[
T \sim \mathrm{Beta}(\alpha(a),\beta(a)).
\]</span></li>
</ul>
<ul>
<li class="fragment">Age-dependent shape parameters: <span class="math display">\[
\alpha(a)=\alpha_0\,a^{\gamma}, \quad \beta(a)=\beta_0\,a^{\delta(a)}.
\]</span></li>
<li class="fragment">Piecewise age effect in <span class="math inline">\(\beta(a)\)</span> with change-point <span class="math inline">\(\tau_{cp}\)</span>: <span class="math display">\[
\delta(a)=
\begin{cases}
\delta_1, &amp; a \le \tau_{cp},\\
\delta_1+\delta_2, &amp; a &gt; \tau_{cp}.
\end{cases}
\]</span></li>
<li class="fragment">Induced mean of <span class="math inline">\(T\)</span> for <span class="math inline">\(a \ge \tau_{cp}\)</span>: <span class="math display">\[
\mathbb{E}[T;a]=\left\{1+\frac{\beta_0}{\alpha_0}a^{\delta_1+\delta_2-\gamma}\right\}^{-1}.
\]</span></li>
</ul>
</div>
</section>
<section id="msp1-parameter-estimates" class="slide level2">
<h2>MSP1: parameter estimates</h2>
<table style="font-size:0.65em; line-height:1.15; border-collapse:collapse;">
<thead>
<tr>
<th style="border:none;">
Parameter
</th>
<th style="border:none;">
Mean
</th>
<th style="border:none;">
SD
</th>
<th style="border:none;">
2.5%
</th>
<th style="border:none;">
50%
</th>
<th style="border:none;">
97.5%
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="6" style="border:none;">
<em>Distribution of Y | T</em>
</td>
</tr>
<tr>
<td style="border:none;">
Œº<sub>0</sub>
</td>
<td style="border:none;">
-4.481
</td>
<td style="border:none;">
0.042
</td>
<td style="border:none;">
-4.567
</td>
<td style="border:none;">
-4.479
</td>
<td style="border:none;">
-4.404
</td>
</tr>
<tr>
<td style="border:none;">
Œº<sub>1</sub>
</td>
<td style="border:none;">
1.255
</td>
<td style="border:none;">
0.026
</td>
<td style="border:none;">
1.205
</td>
<td style="border:none;">
1.255
</td>
<td style="border:none;">
1.307
</td>
</tr>
<tr>
<td style="border:none;">
log&nbsp;œÉ<sub>0</sub>
</td>
<td style="border:none;">
-0.677
</td>
<td style="border:none;">
0.043
</td>
<td style="border:none;">
-0.764
</td>
<td style="border:none;">
-0.676
</td>
<td style="border:none;">
-0.599
</td>
</tr>
<tr>
<td style="border:none;">
log&nbsp;œÉ<sub>1</sub>
</td>
<td style="border:none;">
-5.716
</td>
<td style="border:none;">
0.536
</td>
<td style="border:none;">
-6.892
</td>
<td style="border:none;">
-5.666
</td>
<td style="border:none;">
-4.874
</td>
</tr>
<tr>
<td colspan="6" style="border:none;">
<em>Distribution of T</em>
</td>
</tr>
<tr>
<td style="border:none;">
Œ±<sub>0</sub>
</td>
<td style="border:none;">
0.093
</td>
<td style="border:none;">
0.036
</td>
<td style="border:none;">
0.025
</td>
<td style="border:none;">
0.093
</td>
<td style="border:none;">
0.166
</td>
</tr>
<tr>
<td style="border:none;">
Œ≥<sub>1</sub>
</td>
<td style="border:none;">
0.277
</td>
<td style="border:none;">
0.011
</td>
<td style="border:none;">
0.256
</td>
<td style="border:none;">
0.277
</td>
<td style="border:none;">
0.297
</td>
</tr>
<tr>
<td style="border:none;">
Œ≤<sub>0</sub>
</td>
<td style="border:none;">
0.755
</td>
<td style="border:none;">
0.037
</td>
<td style="border:none;">
0.684
</td>
<td style="border:none;">
0.754
</td>
<td style="border:none;">
0.827
</td>
</tr>
<tr>
<td style="border:none;">
Œ¥<sub>1</sub>
</td>
<td style="border:none;">
0.110
</td>
<td style="border:none;">
0.018
</td>
<td style="border:none;">
0.075
</td>
<td style="border:none;">
0.110
</td>
<td style="border:none;">
0.145
</td>
</tr>
<tr>
<td style="border:none;">
œÑ<sub>cp</sub>
</td>
<td style="border:none;">
11.623
</td>
<td style="border:none;">
0.406
</td>
<td style="border:none;">
11.004
</td>
<td style="border:none;">
11.667
</td>
<td style="border:none;">
12.197
</td>
</tr>
<tr>
<td style="border:none;">
Œ¥<sub>2</sub>
</td>
<td style="border:none;">
-0.061
</td>
<td style="border:none;">
0.010
</td>
<td style="border:none;">
-0.080
</td>
<td style="border:none;">
-0.061
</td>
<td style="border:none;">
-0.042
</td>
</tr>
</tbody>
</table>
</section>
<section id="msp1-analysis-results" class="slide level2">
<h2>MSP1 analysis: results</h2>

<img data-src="figures/joint_msp.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="predicted-antibody-levels-in-ama1-and-msp1" class="slide level2">
<h2>Predicted antibody levels in AMA1 and MSP1</h2>

<img data-src="figures/fig_expected_log_ab_by_age.png" class="r-stretch"></section>
<section id="summary-and-conclusions" class="slide level2 smaller">
<h2>Summary and conclusions</h2>
<div style="font-size:1.2em; line-height:1.15;">
<ul>
<li class="fragment">We proposed a latent-variable framework that <u>generalizes finite mixture models</u>.</li>
<li class="fragment">It allows <u>flexible age-dependent modelling.</u></li>
<li class="fragment">Modelling of the latent variable (seroreactivity) can be done using <u>data-driven or mechanistic approaches</u>.</li>
<li class="fragment">We are working to extend the proposed model to
<ul>
<li class="fragment">analyse <u>geostatistical</u> and <u>longitudinal</u> data-sets;</li>
<li class="fragment"><u>jointly model</u> multiple antibodies.</li>
</ul></li>
</ul>
</div>
</section>
<section id="thank-you" class="slide level2 smaller">
<h2>THANK YOU!</h2>
<center>
<img data-src="figures/questions.jpg" style="height:4in">
</center>
<p>üîó <a href="https://giorgistat.github.io">giorgistat.github.io</a><br>
üìß e.giorgi@bham.ac.uk<br>
üìç BESTEAM, Department of Applied Health Sciences, University of Birmingham</p>
</section>
<section id="inference" class="slide level2 smaller">
<h2>Inference</h2>
<div style="font-size:0.8em; line-height:1.15; max-height:650px; overflow-y:auto; padding-right:10px;">
<ul>
<li><p>Two complementary inference approaches are used:</p>
<ol type="i">
<li>full maximum likelihood, and<br>
</li>
<li>a fast histogram-based approximation for exploratory fitting and initialisation.</li>
</ol></li>
<li><p>Conditional on the latent immune state <span class="math inline">\(T\)</span>, antibody concentrations are Gaussian with mean and variance interpolating between low and high sero-reactivity extremes.<br>
The marginal density of <span class="math inline">\(Y\)</span> is obtained by integrating out <span class="math inline">\(T\)</span>: <span class="math display">\[
f(y;\boldsymbol\theta,\boldsymbol\psi)=\int_0^1
\phi\!\left(y;(1-t)\mu_0+t\mu_1,(1-t)\sigma_0^2+t\sigma_1^2\right)
\,g_T(t;\boldsymbol\psi)\,dt.
\]</span></p></li>
<li><p>Exact maximum likelihood is based on <span class="math display">\[
\ell(\boldsymbol\theta,\boldsymbol\psi)=\sum_{i=1}^n\log f(y_i;\boldsymbol\theta,\boldsymbol\psi),
\]</span> but direct maximisation is computationally intensive due to repeated numerical integration.</p></li>
<li><p>To reduce computation, data are summarised into a histogram.<br>
Let <span class="math inline">\(\widehat f_j = n_j/(n\Delta_j)\)</span> be the empirical density in bin <span class="math inline">\(j\)</span>, and approximate model probabilities by evaluation at bin midpoints: <span class="math display">\[
p_j(\boldsymbol\theta,\boldsymbol\psi)\approx f(m_j;\boldsymbol\theta,\boldsymbol\psi)\Delta_j.
\]</span></p></li>
<li><p>Parameters are estimated by minimising an <span class="math inline">\(L_2\)</span> distance between empirical and model densities: <span class="math display">\[
Q(\boldsymbol\theta,\boldsymbol\psi)=\sum_{j=1}^J\{\widehat f_j-f(m_j;\boldsymbol\theta,\boldsymbol\psi)\}^2.
\]</span> This yields a robust minimum-distance estimator and is computationally efficient when <span class="math inline">\(J\ll n\)</span>.</p></li>
</ul>
</div>
</section>
<section id="exploratory-analysis-ama1" class="slide level2">
<h2>Exploratory analysis: AMA1</h2>

<img data-src="figures/ama_expl.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="exploratory-analysis-msp1" class="slide level2">
<h2>Exploratory analysis: MSP1</h2>

<img data-src="figures/msp_expl.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="antibody-measurement-how-elisa-works" class="slide level2 smaller">
<h2>Antibody measurement: How ELISA Works</h2>
<iframe src="https://www.youtube.com/embed/ERk0hwqhyDw" style="width:100%; height:65vh;" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="figures/uob_logo_v2.jpg" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/giorgistat\.github\.io\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>